<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="email_template_edi_sale_cerfa" model="mail.template">
        <field name="name">Sales: Send Quotation and Cerfa link</field>
        <field name="model_id" ref="sale.model_sale_order"/>
        <field name="subject">{{ object.company_id.name }} {{ object.state in ('draft', 'sent') and (ctx.get('proforma') and 'Proforma' or 'Quotation') or 'Order' }} (Ref {{ object.name or 'n/a' }})</field>
        <field name="email_from">{{ (object.user_id.email_formatted or object.company_id.email_formatted or user.email_formatted) }}</field>
        <field name="partner_to">{{ object.partner_id.id }}</field>
        <field name="description">Used by salespeople when they send quotations or proforma to prospects</field>
        <field name="body_html" type="html">
            <div style="margin: 0px; padding: 0px;">
                <p style="margin: 0px; padding: 0px; font-size: 13px;">
                    <t t-set="doc_name" t-value="'quotation' if object.state in ('draft', 'sent') else 'order'"/>
                    Hello,
                    <br/><br/>
                    Your
                    <t t-if="ctx.get('proforma')">
                        Pro forma invoice for <t t-out="doc_name or ''">quotation</t> <span style="font-weight: bold;"  t-out="object.name or ''">S00052</span>
                        <t t-if="object.origin">
                            (with reference: <t t-out="object.origin or ''"></t> )
                        </t>
                        amounting in <span style="font-weight: bold;"  t-out="format_amount(object.amount_total, object.currency_id) or ''">$ 10.00</span> is available.
                    </t>
                    <t t-else="">
                        <t t-out="doc_name or ''">quotation</t> <span style="font-weight: bold;" t-out="object.name or ''"></span>
                        <t t-if="object.origin">
                            (with reference: <t t-out="object.origin or ''">S00052</t> )
                        </t>
                        amounting in <span style="font-weight: bold;" t-out="format_amount(object.amount_total, object.currency_id) or ''">$ 10.00</span> is ready for review.
                    </t>
<!--                        <t t-if="ctx.get('cerfa')">-->
<!--                        </t>-->

                    <tr><td valign="top">
                        <div style="margin:16px auto; text-align:center;">
                            <t t-set="link_cerfa" t-value="object.link"/>
                            <a t-att-href="link_cerfa"
                                style="padding: 8px 16px 8px 16px; border-radius: 3px; background-color:#875A7B; text-align:center; text-decoration:none; color: #FFFFFF;">
                                Sign document
                            </a>
                        </div>
                    </td></tr>
                    <br/><br/>
                    Do not hesitate to contact us if you have any questions.
                    <t t-if="not is_html_empty(object.user_id.signature)">
                        <br/><br/>
                        <t t-out="object.user_id.signature or ''">--<br/>Mitchell Admin</t>
                    </t>
                    <br/><br/>
                </p>
            </div>
        </field>
        <field name="report_template_ids" eval="[(4, ref('sale.action_report_saleorder'))]"/>
        <field name="lang">{{ object.partner_id.lang }}</field>
        <field name="auto_delete" eval="True"/>
    </record>

    <record id="email_template_edi_after_sale_cerfa" model="mail.template">
        <field name="name">Sales: Cerfa link after sale confirmation</field>
        <field name="model_id" ref="sale.model_sale_order"/>
        <field name="subject">{{ object.company_id.name }} {{ object.state in ('draft', 'sent') and (ctx.get('proforma') and 'Proforma' or 'Quotation') or 'Order' }} (Ref {{ object.name or 'n/a' }})</field>
        <field name="email_from">{{ (object.user_id.email_formatted or object.company_id.email_formatted or user.email_formatted) }}</field>
        <field name="partner_to">{{ object.partner_id.id }}</field>
        <field name="body_html" type="html">
            <div style="margin: 0px; padding: 0px;">
                <p style="margin: 0px; padding: 0px; font-size: 13px;">
                    <t t-set="doc_name" t-value="'quotation' if object.state in ('draft', 'sent') else 'order'"/>
                    Hello,
                    <br/><br/>
                    Thank you for your order.

                        <t t-out="doc_name or ''">quotation</t> <span style="font-weight: bold;" t-out="object.name or ''"></span>
                        <t t-if="object.origin">
                            (with reference: <t t-out="object.origin or ''">S00052</t> )
                        </t>
                        amounting in <span style="font-weight: bold;" t-out="format_amount(object.amount_total, object.currency_id) or ''">$ 10.00</span>

                    <br/><br/>
                    As permitted by law, we have provided you with a quote that includes a reduced VAT rate.
                    In order for us to carry out these works at the reduced rate,
                    you need to complete the online form we have prepared for you.
                    This simplified certificate guarantees the conditions stipulated in
                    Articles 278-0 ter and 279-0 bis of the CGI to benefit from the reduced VAT rate
                    for works on residential premises over 2 years old.
                    <br/><br/>
                    <tr><td valign="top">
                        <div style="margin:16px auto; text-align:center;">
                            <t t-set="link_cerfa" t-value="object.link"/>
                            <a t-att-href="link_cerfa"
                                style="padding: 8px 16px 8px 16px; border-radius: 3px; background-color:#875A7B; text-align:center; text-decoration:none; color: #FFFFFF;">
                                Sign document
                            </a>
                        </div>
                    </td></tr>
                    <br/><br/>
                    Do not hesitate to contact us if you have any questions.
                    <t t-if="not is_html_empty(object.user_id.signature)">
                        <br/><br/>
                        <t t-out="object.user_id.signature or ''">--<br/>Mitchell Admin</t>
                    </t>
                    <br/><br/>
                </p>
            </div>
        </field>
        <field name="report_template_ids" eval="[(4, ref('sale.action_report_saleorder'))]"/>
        <field name="lang">{{ object.partner_id.lang }}</field>
        <field name="auto_delete" eval="True"/>
    </record>
</odoo>
